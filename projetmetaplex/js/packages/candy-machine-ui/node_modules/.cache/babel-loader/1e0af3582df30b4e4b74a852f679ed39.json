{"ast":null,"code":"var id = 0;\nvar subscribers = [];\n/**\n * log something\n * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n * @param message a clear message of the log associated to the type\n */\n\nexport var log = function (type, message, data) {\n  var obj = {\n    type: type,\n    id: String(++id),\n    date: new Date()\n  };\n  if (message) obj.message = message;\n  if (data) obj.data = data;\n  dispatch(obj);\n};\n/**\n * listen to logs.\n * @param cb that is called for each future log() with the Log object\n * @return a function that can be called to unsubscribe the listener\n */\n\nexport var listen = function (cb) {\n  subscribers.push(cb);\n  return function () {\n    var i = subscribers.indexOf(cb);\n\n    if (i !== -1) {\n      // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n      subscribers[i] = subscribers[subscribers.length - 1];\n      subscribers.pop();\n    }\n  };\n};\n\nfunction dispatch(log) {\n  for (var i = 0; i < subscribers.length; i++) {\n    try {\n      subscribers[i](log);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\n\nif (typeof window !== \"undefined\") {\n  window.__ledgerLogsListen = listen;\n}","map":{"version":3,"mappings":"AAcA,IAAIA,EAAE,GAAG,CAAT;AACA,IAAMC,WAAW,GAAiB,EAAlC;AAEA;;;;;;AAKA,OAAO,IAAMC,GAAG,GAAG,UAACC,IAAD,EAAeC,OAAf,EAAiCC,IAAjC,EAA2C;EAC5D,IAAMC,GAAG,GAAQ;IACfH,IAAI,MADW;IAEfH,EAAE,EAAEO,MAAM,CAAC,EAAEP,EAAH,CAFK;IAGfQ,IAAI,EAAE,IAAIC,IAAJ;EAHS,CAAjB;EAKA,IAAIL,OAAJ,EAAaE,GAAG,CAACF,OAAJ,GAAcA,OAAd;EACb,IAAIC,IAAJ,EAAUC,GAAG,CAACD,IAAJ,GAAWA,IAAX;EACVK,QAAQ,CAACJ,GAAD,CAAR;AACD,CATM;AAWP;;;;;;AAKA,OAAO,IAAMK,MAAM,GAAG,UAACC,EAAD,EAAe;EACnCX,WAAW,CAACY,IAAZ,CAAiBD,EAAjB;EACA,OAAO;IACL,IAAME,CAAC,GAAGb,WAAW,CAACc,OAAZ,CAAoBH,EAApB,CAAV;;IAEA,IAAIE,CAAC,KAAK,CAAC,CAAX,EAAc;MACZ;MACAb,WAAW,CAACa,CAAD,CAAX,GAAiBb,WAAW,CAACA,WAAW,CAACe,MAAZ,GAAqB,CAAtB,CAA5B;MACAf,WAAW,CAACgB,GAAZ;IACD;EACF,CARD;AASD,CAXM;;AAaP,SAASP,QAAT,CAAkBR,GAAlB,EAA0B;EACxB,KAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGb,WAAW,CAACe,MAAhC,EAAwCF,CAAC,EAAzC,EAA6C;IAC3C,IAAI;MACFb,WAAW,CAACa,CAAD,CAAX,CAAeZ,GAAf;IACD,CAFD,CAEE,OAAOgB,CAAP,EAAU;MACVC,OAAO,CAACC,KAAR,CAAcF,CAAd;IACD;EACF;AACF;;AAUD,IAAI,OAAOG,MAAP,KAAkB,WAAtB,EAAmC;EACjCA,MAAM,CAACC,kBAAP,GAA4BX,MAA5B;AACD","names":["id","subscribers","log","type","message","data","obj","String","date","Date","dispatch","listen","cb","push","i","indexOf","length","pop","e","console","error","window","__ledgerLogsListen"],"sourceRoot":"","sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}